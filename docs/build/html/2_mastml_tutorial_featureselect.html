

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Feature selection and learning curves &mdash; MAterials Simulation Toolkit for Machine Learning (MAST-ML) 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hyperparameter optimization" href="2_mastml_tutorial_hyperparam.html" />
    <link rel="prev" title="Training and evaluating your first model" href="2_mastml_tutorial_firstmodel.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MAterials Simulation Toolkit for Machine Learning (MAST-ML)
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="00_acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="0_installation.html">Installing MAST-ML</a><ul>
<li class="toctree-l2"><a class="reference internal" href="0_1_hardware_data_requirements.html">Hardware and Data Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_1_hardware_data_requirements.html#hardware">Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_1_hardware_data_requirements.html#data">Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_1_terminal_installation.html">Terminal installation (Linux or linux-like terminal on Mac)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_1_terminal_installation.html#install-python3">Install Python3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#create-a-conda-environment">Create a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#set-up-juptyer-notebooks">Set up Juptyer notebooks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0_1_terminal_installation.html#install-the-mast-ml-package">Install the MAST-ML package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#imports-that-dont-work">Imports that don’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_2_windows_installation.html">Windows installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_2_windows_installation.html#install-python3">Install Python3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#create-a-conda-environment">Create a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#set-up-the-spyder-ide-and-jupyter-notebooks">Set up the Spyder IDE and Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0_2_windows_installation.html#install-the-mast-ml-package">Install the MAST-ML package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#imports-that-dont-work">Imports that don’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_3_startup.html">Startup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#locate-the-examples-folder">Locate the examples folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#run-the-mastml-command">Run the MASTML command</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#check-output">Check output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1_mastml_inputfile.html">MAST-ML Input File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="1_mastml_inputfile.html#input-file-sections">Input file sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#general-setup">General Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#data-cleaning">Data Cleaning</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#clustering">Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-generation">Feature Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-normalization">Feature Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#learning-curve">Learning Curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-selection">Feature Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#data-splits">Data Splits</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#plot-settings">Plot Settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2_mastml_overview.html">MAST-ML overview slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_running_mastml_nanohub.html">Running MAST-ML on Nanohub</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="2_mastml_tutorial.html">MAST-ML tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_firstrun.html">Your first MAST-ML run</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_cleaning.html">Cleaning input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_featuregen.html">Feature generation and normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_firstmodel.html">Training and evaluating your first model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Feature selection and learning curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_hyperparam.html">Hyperparameter optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_logcv.html">Random leave-out versus leave-out-group cross-validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_modelimport.html">Making predictions by importing a previously fit model</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_prediction.html">Predicting values for new, extrapolated data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_code_documentation.html">MAST-ML Code Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="3_metrics.html">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_conf_parser.html">Configuration file parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_data_cleaner.html">Data cleaner</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_data_loader.html">Data loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_learning_curve.html">Learning curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_clusterers.html">Clusterers</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_data_splitters.html">Data splitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_utils.html">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_mastml_driver.html">MAST-ML Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_plot_helper.html">Plot Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_html_helper.html">HTML Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_feature_selectors.html">Feature Selectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_feature_normalizers.html">Feature Normalizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_randomizers.html">Randomizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_model_finder.html">Model Finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_util_legos.html">Utility Legos</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_feature_generators.html">Feature Generators</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAterials Simulation Toolkit for Machine Learning (MAST-ML)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="2_mastml_tutorial.html">MAST-ML tutorial</a> &raquo;</li>
        
      <li>Feature selection and learning curves</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/2_mastml_tutorial_featureselect.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="feature-selection-and-learning-curves">
<h1>Feature selection and learning curves<a class="headerlink" href="#feature-selection-and-learning-curves" title="Permalink to this headline">¶</a></h1>
<p>As mentioned above, one problem with our current model is over-fitting. To further understand and minimize the effect of
over-fitting, it is often necessary to construct learning curves and perform feature selection to obtain a reduced feature
set which most accurately describes your data. To do this, we are going to add two additional sections to our input file.</p>
<p>The first section is related to feature selection. Here, we will use the SequentialFeatureSelector algorithm, which
performs forward selection of features. We will select a total of 20 features, and use a KernelRidge model to evaluate
the selected features. Here, we ahve denoted our estimator as “KernelRidge_select”. The models used in feature selection
and learning curves are removed from the model queue, because in general one may want to use a different model for this
step of the analysis than what will ultimately be used for fitting. Therefore, we need to also amend our models list to
have this new KernelRidge_select model, as shown below.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">FeatureSelection</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">SequentialFeatureSelector</span><span class="p">]]</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">KernelRidge_select</span>
        <span class="n">k_features</span> <span class="o">=</span> <span class="mi">20</span>

<span class="p">[</span><span class="n">Models</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">KernelRidge</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="n">KernelRidge_select</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The second section we will add is to plot learning curves. There are two types of learning curves MAST-ML can make: a
data learning curve and feature learning curve. The former is a plot of the metric of interest versus the amount of
training data used in the fits. The latter is a plot of the metric of interest versus the number of features comprising
the X feature matrix. In the example LearningCurve input file section shown below, we are going to use a KernelRidge
model, a random k-fold cross-validation and the root_mean_square_error to evaluate our learning curves. We will also
use a maximum of 20 features, and use the SelectKBest algorithm to assess the choice of features.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">LearningCurve</span><span class="p">]</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">KernelRidge_learn</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">RepeatedKFold_learn</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span>
    <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">selector_name</span> <span class="o">=</span> <span class="n">SelectKBest</span>
</pre></div>
</div>
<p>As with the above example of FeatureSelection, we need to add the KernelRidge_learn and RepeatedKFold_learn entries to
the Models and DataSplits sections of our input file, respectively. At this point in the tutorial, the complete input
file should look like this:</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">GeneralSetup</span><span class="p">]</span>
    <span class="n">input_features</span> <span class="o">=</span> <span class="n">Auto</span>
    <span class="n">input_target</span> <span class="o">=</span> <span class="n">Reduced</span> <span class="n">barrier</span> <span class="p">(</span><span class="n">eV</span><span class="p">)</span>
    <span class="n">randomizer</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">Auto</span>
    <span class="n">input_other</span> <span class="o">=</span> <span class="n">Host</span> <span class="n">element</span><span class="p">,</span> <span class="n">Solute</span> <span class="n">element</span><span class="p">,</span> <span class="n">predict_Pt</span>

<span class="p">[</span><span class="n">DataCleaning</span><span class="p">]</span>
    <span class="n">cleaning_method</span> <span class="o">=</span> <span class="n">imputation</span>
    <span class="n">imputation_strategy</span> <span class="o">=</span> <span class="n">mean</span>

<span class="p">[</span><span class="n">FeatureGeneration</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">Magpie</span><span class="p">]]</span>
        <span class="n">composition_feature</span> <span class="o">=</span> <span class="n">Solute</span> <span class="n">element</span>

<span class="p">[</span><span class="n">FeatureNormalization</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">StandardScaler</span><span class="p">]]</span>

<span class="p">[</span><span class="n">FeatureSelection</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">SequentialFeatureSelector</span><span class="p">]]</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">KernelRidge_select</span>
        <span class="n">k_features</span> <span class="o">=</span> <span class="mi">20</span>

<span class="p">[</span><span class="n">LearningCurve</span><span class="p">]</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">KernelRidge_learn</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">RepeatedKFold_learn</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span>
    <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">selector_name</span> <span class="o">=</span> <span class="n">SelectKBest</span>

<span class="p">[</span><span class="n">Models</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">KernelRidge</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="n">KernelRidge_select</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="n">KernelRidge_learn</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>

<span class="p">[</span><span class="n">DataSplits</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">NoSplit</span><span class="p">]]</span>
    <span class="p">[[</span><span class="n">RepeatedKFold</span><span class="p">]]</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="p">[[</span><span class="n">RepeatedKFold_learn</span><span class="p">]]</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Let’s take a look at the same full fit and RepeatedKFold random cross-validation tests for this run:</p>
<p>Full-fit:</p>
<img alt="_images/MASTMLtutorial_run5_1.png" src="_images/MASTMLtutorial_run5_1.png" />
<p>Random leave out cross-validation:</p>
<img alt="_images/MASTMLtutorial_run5_2.png" src="_images/MASTMLtutorial_run5_2.png" />
<p>What we can see is, now that we down-selected features from more than 300 features in the previous run to just 20 here,
that the fits have noticeably improved and the problem of over-fitting has been minimized. Below, we can look at the
plotted learning curves</p>
<p>Data learning curve:</p>
<img alt="_images/MASTMLtutorial_run5_3.png" src="_images/MASTMLtutorial_run5_3.png" />
<p>Feature learning curve:</p>
<img alt="_images/MASTMLtutorial_run5_4.png" src="_images/MASTMLtutorial_run5_4.png" />
<p>We can clearly see that, as expected, having more training data will result in better test scores, and adding more features
(up to a certain point) will also result in better fits. Based on these learning curves, one may be able to argue that
additional features should could be used to further lower the error.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2_mastml_tutorial_hyperparam.html" class="btn btn-neutral float-right" title="Hyperparameter optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2_mastml_tutorial_firstmodel.html" class="btn btn-neutral" title="Training and evaluating your first model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, University of Wisconsin-Madison Computational Materials Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>