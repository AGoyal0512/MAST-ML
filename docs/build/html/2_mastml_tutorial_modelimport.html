

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Making predictions by importing a previously fit model &mdash; MAterials Simulation Toolkit for Machine Learning (MAST-ML) 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Predicting values for new, extrapolated data" href="2_mastml_tutorial_prediction.html" />
    <link rel="prev" title="Random leave-out versus leave-out-group cross-validation" href="2_mastml_tutorial_logcv.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MAterials Simulation Toolkit for Machine Learning (MAST-ML)
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="00_acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="0_installation.html">Installing MAST-ML</a><ul>
<li class="toctree-l2"><a class="reference internal" href="0_1_hardware_data_requirements.html">Hardware and Data Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_1_hardware_data_requirements.html#hardware">Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_1_hardware_data_requirements.html#data">Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_1_terminal_installation.html">Terminal installation (Linux or linux-like terminal on Mac)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_1_terminal_installation.html#install-python3">Install Python3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#create-a-conda-environment">Create a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#set-up-juptyer-notebooks">Set up Juptyer notebooks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0_1_terminal_installation.html#install-the-mast-ml-package">Install the MAST-ML package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_1_terminal_installation.html#imports-that-dont-work">Imports that don’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_2_windows_installation.html">Windows installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_2_windows_installation.html#install-python3">Install Python3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#create-a-conda-environment">Create a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#set-up-the-spyder-ide-and-jupyter-notebooks">Set up the Spyder IDE and Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0_2_windows_installation.html#install-the-mast-ml-package">Install the MAST-ML package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0_2_windows_installation.html#imports-that-dont-work">Imports that don’t work</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0_2_windows_installation.html#windows-10-install-step-by-step-guide-credit-joe-kern">Windows 10 install: step-by-step guide (credit Joe Kern)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_3_startup.html">Startup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#locate-the-examples-folder">Locate the examples folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#run-the-mastml-command">Run the MASTML command</a></li>
<li class="toctree-l3"><a class="reference internal" href="0_3_startup.html#check-output">Check output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1_mastml_inputfile.html">MAST-ML Input File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="1_mastml_inputfile.html#input-file-sections">Input file sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#general-setup">General Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#data-cleaning">Data Cleaning</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#clustering">Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-generation">Feature Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-normalization">Feature Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#learning-curve">Learning Curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#feature-selection">Feature Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#data-splits">Data Splits</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_mastml_inputfile.html#misc-settings">Misc Settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2_mastml_overview.html">MAST-ML overview slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_running_mastml_nanohub.html">Running MAST-ML on Nanohub</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="2_mastml_tutorial.html">MAST-ML tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_firstrun.html">Your first MAST-ML run</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_cleaning.html">Cleaning input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_featuregen.html">Feature generation and normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_firstmodel.html">Training and evaluating your first model</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_featureselect.html">Feature selection and learning curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_hyperparam.html">Hyperparameter optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_logcv.html">Random leave-out versus leave-out-group cross-validation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Making predictions by importing a previously fit model</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_mastml_tutorial_prediction.html">Predicting values for new, extrapolated data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_metrics.html">Metrics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="3_metrics.html#module-mastml.metrics">mastml.metrics Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3_metrics.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.adjusted_r2_score.html">adjusted_r2_score</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.check_and_fetch_names.html">check_and_fetch_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.r2_score_fitted.html">r2_score_fitted</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.r2_score_noint.html">r2_score_noint</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.rmse_over_stdev.html">rmse_over_stdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/mastml.metrics.root_mean_squared_error.html">root_mean_squared_error</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAterials Simulation Toolkit for Machine Learning (MAST-ML)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="2_mastml_tutorial.html">MAST-ML tutorial</a> &raquo;</li>
        
      <li>Making predictions by importing a previously fit model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/2_mastml_tutorial_modelimport.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="making-predictions-by-importing-a-previously-fit-model">
<h1>Making predictions by importing a previously fit model<a class="headerlink" href="#making-predictions-by-importing-a-previously-fit-model" title="Permalink to this headline">¶</a></h1>
<p>Here, we are going to import a previously fit model, and use it to predict the migration barriers for
those data points with Pt as the host element.</p>
<p>In your previous run, the LOG test split where the Pt host values were predicted is in the split_12 folder. The parity
plot for Pt test data should look like the below plot for your previous run:</p>
<img alt="_images/MASTMLtutorial_run8_1.png" src="_images/MASTMLtutorial_run8_1.png" />
<p>Here, we are going to import the model that was fitted to all the groups except Pt, and use MAST-ML’s data validation function
as detailed above to obtain this same plot, but with using Pt as the validation data and the imported, previously trained model.
If one were to extend this data set to include, for example, U as a host element, any number of previously trained models
could be used to predict the migration barrier values for U. To import this model, save the KernelRidge_split_12.pkl file
from your previous run into the /models/ folder (it is as the the same level as the /tests/ folder in your main MAST-ML
directory). To import this model into your next run, you can create a new field in the Models section, as shown below:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Models</span><span class="p">]</span>
    <span class="c1">#[[KernelRidge]]</span>
    <span class="c1">#    kernel = rbf</span>
    <span class="c1">#    alpha = 0.034</span>
    <span class="c1">#    gamma = 0.138</span>
    <span class="c1">#[[KernelRidge_select]]</span>
    <span class="c1">#    kernel = rbf</span>
    <span class="c1">#    alpha = 1</span>
    <span class="c1">#    gamma = 1</span>
    <span class="c1">#[[KernelRidge_learn]]</span>
    <span class="c1">#    kernel = rbf</span>
    <span class="c1">#    alpha = 1</span>
    <span class="c1">#    gamma = 1</span>
    <span class="p">[[</span><span class="n">ModelImport</span><span class="p">]]</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="n">models</span><span class="o">/</span><span class="n">KernelRidge_split_12</span><span class="o">.</span><span class="n">pkl</span>
</pre></div>
</div>
<p>As we are only interested in assessing the fit on Pt for this example, we can change the DataSplits section to only have
the LOG test:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DataSplits</span><span class="p">]</span>
    <span class="c1">#[[NoSplit]]</span>
    <span class="p">[[</span><span class="n">RepeatedKFold</span><span class="p">]]</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="c1">#[[RepeatedKFold_learn]]</span>
    <span class="c1">#    n_splits = 5</span>
    <span class="c1">#    n_repeats = 2</span>
    <span class="p">[[</span><span class="n">LeaveOneGroupOut</span><span class="p">]]</span>
        <span class="n">grouping_column</span> <span class="o">=</span> <span class="n">Host</span> <span class="n">element</span>
</pre></div>
</div>
<p>From running this model and inspecting the test data parity plot in split_12 (the folder for Pt group, we obtain this parity plot:</p>
<img alt="_images/MASTMLtutorial_run8_2.png" src="_images/MASTMLtutorial_run8_2.png" />
<p>As a comparison, this plot is exactly the same as the above plot from the previous run. This is the expected result, and
demonstrates that the previously fit model was successfully imported and used to predict the Pt values. By inspecting the
other groups, for example split_1, which is for Ag, the R squared and errors indicate a better fit than our previous run.
This better fit is expected, as the model we saved from the previous run contained Ag in the training data, so these predictions
on Ag should be improved (note that this is defeats the purpose of the LOG test, but shows that the trained model we imported
is behaving as expected).</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2_mastml_tutorial_prediction.html" class="btn btn-neutral float-right" title="Predicting values for new, extrapolated data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2_mastml_tutorial_logcv.html" class="btn btn-neutral" title="Random leave-out versus leave-out-group cross-validation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, University of Wisconsin-Madison Computational Materials Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>