
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Training and evaluating your first model &#8212; MAterials Simulation Toolkit for Machine Learning (MAST-ML) 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Feature selection and learning curves" href="2_mastml_tutorial_featureselect.html" />
    <link rel="prev" title="Feature generation and normalization" href="2_mastml_tutorial_featuregen.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="2_mastml_tutorial_featureselect.html" title="Feature selection and learning curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="2_mastml_tutorial_featuregen.html" title="Feature generation and normalization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MAterials Simulation Toolkit for Machine Learning (MAST-ML) 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="2_mastml_tutorial.html" accesskey="U">MAST-ML tutorial</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="training-and-evaluating-your-first-model">
<h1>Training and evaluating your first model<a class="headerlink" href="#training-and-evaluating-your-first-model" title="Permalink to this headline">¶</a></h1>
<p>Now that we have a full X feature matrix that has been normalized appropriately, it is time to train and evaluate your
first model. For this tutorial, we will train a Kernel Ridge model with a radial basis function kernel (also known as
Gaussian Kernel Ridge Regression, GKRR). We need to add two sections of our input file.</p>
<p>The first is the Models section, which provides a list of model types to train and the associated parameter values for
each model. Here, we have chosen values of alpha and gamma equal to 1. There is no reason to think that these are the
optimal parameter values, they were simply chosen as an example. Later in this tutorial we will optimize these
parameters. Note that if you don’t specify the model parameter values, the values used will be the scikit-learn default values.</p>
<p>The second is the DataSplits section, which controls what types of fits and cross-validation tests will be applied to
each specified model. Here, we have chosen “NoSplit”, which is simply a full y versus X fit of the data, without any
form of cross-validation. We have also denoted “RepeatedKFold”, which is random leave-out cross-validation test. In this
instance, we have 5 splits (so leave out 20%) and do the test two times.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Models</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">KernelRidge</span><span class="p">]]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>

<span class="p">[</span><span class="n">DataSplits</span><span class="p">]</span>
    <span class="p">[[</span><span class="n">NoSplit</span><span class="p">]]</span>
    <span class="p">[[</span><span class="n">RepeatedKFold</span><span class="p">]]</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Below is a snapshot of the resulting directory tree generated from this MAST-ML run. You’ll immediately notice the tree
is deeper now, with a new level corresponding to each model we’ve fit (here just the single KernelRidge model), and, for
each model, folders corresponding to each DataSplit test we denoted in the input file. For each data split method, there
are folders and corresponding data plots and files for each hold-out split of the test. For instance, with the
RepeatedKFold test, there were 10 total splits, which are labeled as split_0 through split_9. Contained in each folder
are numerous files, such as different data parity plots of predicted vs. actual values, histograms of residuals, .csv
files for all plotted data, a .pkl file of the exported trained model, and .ipynb Jupyter notebooks useful for custom
modifications of the data plots.</p>
<img alt="_images/MASTMLtutorial_run4_1.png" src="_images/MASTMLtutorial_run4_1.png" />
<p>Below is a parity plot from the NoSplit (full data fit) run. The R-squared value is high, but there is significant mean
error. This suggests that the model parameters are not optimal (which shouldn’t be surprising considering we just picked
them arbitrarily).</p>
<img alt="_images/MASTMLtutorial_run4_2.png" src="_images/MASTMLtutorial_run4_2.png" />
<p>From examining the parity plot from the RepeatedKFold run (this is the ‘average_points_with_bars.png’ plot), which has
the averaged values over all 10 splits, we can see that the predictions from random cross validation result in both a very
low R-squared value and a high error. Essentially, cross-validation has shown that this model has no predictive ability.
It seems our issues are two-fold: nonoptimal hyperparameters, and over-fitting. The over-fitting is evident due to the much
worse before of the cross-validated parity plot compared to the full fit.</p>
<img alt="_images/MASTMLtutorial_run4_3.png" src="_images/MASTMLtutorial_run4_3.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="2_mastml_tutorial_featureselect.html" title="Feature selection and learning curves"
             >next</a> |</li>
        <li class="right" >
          <a href="2_mastml_tutorial_featuregen.html" title="Feature generation and normalization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MAterials Simulation Toolkit for Machine Learning (MAST-ML) 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="2_mastml_tutorial.html" >MAST-ML tutorial</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, University of Wisconsin-Madison Computational Materials Group.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>